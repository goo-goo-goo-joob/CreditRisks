CREATE DATABASE IF NOT EXISTS risks;
CREATE TABLE IF NOT EXISTS risks.companies
(
    inn    UInt64,
    name   String,
    okpo   UInt64,
    okopf  UInt64,
    okfs   UInt64,
    okved  FixedString(10),
    region UInt8

) ENGINE = MergeTree()
      ORDER BY inn;

-- Загрузка предобработанных данных, сырые содержат ошибки и обязательны к обработке
CREATE TABLE risks.financialReports
(
    year       UInt16,
    inn        UInt64,
    okopf      UInt32,
    okfs       UInt8,
    okved      String,
    type       UInt8,
    code_11003 Int64,
    code_11004 Int64,
    code_11103 Int64,
    code_11104 Int64,
    code_11203 Int32,
    code_11204 Int32,
    code_11303 Int32,
    code_11304 Int32,
    code_11403 Int32,
    code_11404 Int32,
    code_11503 Int32,
    code_11504 Int32,
    code_11603 Int32,
    code_11604 Int32,
    code_11703 Int64,
    code_11704 Int64,
    code_11803 Int32,
    code_11804 Int32,
    code_11903 Int32,
    code_11904 Int32,
    code_12003 Int64,
    code_12004 Int64,
    code_12103 Int64,
    code_12104 Int64,
    code_12203 Int32,
    code_12204 Int32,
    code_12303 Int32,
    code_12304 Int32,
    code_12403 Int64,
    code_12404 Int64,
    code_12503 Int32,
    code_12504 Int32,
    code_12603 Int32,
    code_12604 Int32,
    code_13003 Int64,
    code_13004 Int64,
    code_13103 Int64,
    code_13104 Int64,
    code_13203 Int32,
    code_13204 Int32,
    code_13403 Int32,
    code_13404 Int32,
    code_13503 Int32,
    code_13504 Int32,
    code_13603 Int32,
    code_13604 Int32,
    code_13703 Int64,
    code_13704 Int64,
    code_14003 Int64,
    code_14004 Int64,
    code_14103 Int32,
    code_14104 Int32,
    code_14203 Int32,
    code_14204 Int32,
    code_14303 Int64,
    code_14304 Int64,
    code_14503 Int64,
    code_14504 Int64,
    code_15003 Int64,
    code_15004 Int64,
    code_15103 Int32,
    code_15104 Int32,
    code_15203 Int64,
    code_15204 Int64,
    code_15303 Int32,
    code_15304 Int32,
    code_15403 Int32,
    code_15404 Int32,
    code_15503 Int32,
    code_15504 Int32,
    code_16003 Int64,
    code_16004 Int64,
    code_17003 Int64,
    code_17004 Int64,
    code_21003 Int32,
    code_21004 Int32,
    code_21103 Int64,
    code_21104 Int64,
    code_21203 Int64,
    code_21204 Int64,
    code_22003 Int32,
    code_22004 Int32,
    code_22103 Int64,
    code_22104 Int64,
    code_22203 Int32,
    code_22204 Int32,
    code_23003 Int32,
    code_23004 Int32,
    code_23103 Int32,
    code_23104 Int32,
    code_23203 Int32,
    code_23204 Int32,
    code_23303 Int32,
    code_23304 Int32,
    code_23403 Int64,
    code_23404 Int64,
    code_23503 Int32,
    code_23504 Int32,
    code_24003 Int32,
    code_24004 Int32,
    code_24103 Int32,
    code_24104 Int32,
    code_24213 Int64,
    code_24214 Int64,
    code_24303 Int32,
    code_24304 Int32,
    code_24503 Int32,
    code_24504 Int32,
    code_24603 Int32,
    code_24604 Int32,
    code_25003 Int32,
    code_25004 Int32,
    code_25103 Int32,
    code_25104 Int32,
    code_25203 Int32,
    code_25204 Int32,
    code_32003 Int32,
    code_32004 Int32,
    code_32005 Int32,
    code_32006 Int32,
    code_32007 Int64,
    code_32008 Int64,
    code_33003 Int32,
    code_33004 Int32,
    code_33005 Int32,
    code_33006 Int32,
    code_33007 Int64,
    code_33008 Int64,
    code_33103 Int32,
    code_33104 Int32,
    code_33105 Int32,
    code_33106 Int32,
    code_33107 Int32,
    code_33108 Int32,
    code_33117 Int32,
    code_33118 Int32,
    code_33125 Int32,
    code_33127 Int32,
    code_33128 Int32,
    code_33135 Int32,
    code_33137 Int32,
    code_33138 Int32,
    code_33143 Int32,
    code_33144 Int32,
    code_33145 Int32,
    code_33148 Int32,
    code_33153 Int32,
    code_33154 Int32,
    code_33155 Int32,
    code_33157 Int32,
    code_33163 Int32,
    code_33164 Int32,
    code_33165 Int32,
    code_33166 Int32,
    code_33167 Int32,
    code_33168 Int32,
    code_33203 Int32,
    code_33204 Int32,
    code_33205 Int32,
    code_33206 Int32,
    code_33207 Int32,
    code_33208 Int32,
    code_33217 Int32,
    code_33218 Int32,
    code_33225 Int32,
    code_33227 Int32,
    code_33228 Int32,
    code_33235 Int32,
    code_33237 Int32,
    code_33238 Int32,
    code_33243 Int32,
    code_33244 Int32,
    code_33245 Int32,
    code_33247 Int32,
    code_33248 Int32,
    code_33253 Int32,
    code_33254 Int32,
    code_33255 Int32,
    code_33257 Int32,
    code_33258 Int32,
    code_33263 Int32,
    code_33264 Int32,
    code_33265 Int32,
    code_33266 Int32,
    code_33267 Int32,
    code_33268 Int32,
    code_33277 Int32,
    code_33278 Int32,
    code_33305 Int32,
    code_33306 Int32,
    code_33307 Int32,
    code_33406 Int32,
    code_33407 Int32,
    code_36003 Int64,
    code_36004 Int64,
    code_41003 Int32,
    code_41103 Int64,
    code_41113 Int64,
    code_41123 Int32,
    code_41133 Int32,
    code_41193 Int64,
    code_41203 Int64,
    code_41213 Int64,
    code_41223 Int32,
    code_41233 Int32,
    code_41243 Int32,
    code_41293 Int64,
    code_42003 Int32,
    code_42103 Int64,
    code_42113 Int64,
    code_42123 Int64,
    code_42133 Int64,
    code_42143 Int64,
    code_42193 Int32,
    code_42203 Int64,
    code_42213 Int64,
    code_42223 Int64,
    code_42233 Int64,
    code_42243 Int64,
    code_42293 Int32,
    code_43003 Int32,
    code_43103 Int64,
    code_43113 Int64,
    code_43123 Int64,
    code_43133 Int64,
    code_43143 Int64,
    code_43193 Int32,
    code_43203 Int32,
    code_43213 Int32,
    code_43223 Int32,
    code_43233 Int32,
    code_43293 Int32,
    code_44003 Int32,
    code_44903 Int32,
    code_61003 Int32,
    code_62003 Int32,
    code_62103 Int32,
    code_62153 Int32,
    code_62203 Int32,
    code_62303 Int32,
    code_62403 Int32,
    code_62503 Int32,
    code_63003 Int32,
    code_63103 Int32,
    code_63113 Int32,
    code_63123 Int32,
    code_63133 Int32,
    code_63203 Int32,
    code_63213 Int32,
    code_63223 Int32,
    code_63233 Int32,
    code_63243 Int32,
    code_63253 Int32,
    code_63263 Int32,
    code_63303 Int32,
    code_63503 Int32,
    code_64003 Int32
) ENGINE = MergeTree()
      PARTITION BY year
      ORDER BY inn;

